<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.2/FileSaver.min.js"></script>
    <title>당신의 인디언은?</title>
</head>
<body>
<header>
    <img class="divider" src="images/ui/divider.png">
    <img class="main-title" src="images/ui/main-title.png">
</header>
<div class="container text-center">
    <div id="character" class="my-4 container">
        <div id="capture">
            <div class="character-images" id="background"></div>
            <div class="character-images" id="body"></div>
            <div class="character-images" id="head"></div>
            <div class="character-images" id="hand"></div>
            <div class="character-images" id="clothing"></div>
            <div class="character-images" id="mouth"></div>
            <div class="character-images" id="eyesAndNose"></div>
            <div class="character-images" id="facePaint"></div>
            <div class="character-images" id="weapon"></div>
            <div class="character-images" id="eyebrow"></div>
            <div class="character-images" id="hair"></div>
            <div class="character-images" id="necklace"></div>
            <div class="character-images" id="headAccessory"></div>
        </div>
    </div>
    <div id="menu" class="container">
        <button id="eyesAndNose-button" class="btn">
            <img src="images/ui/button/eyesAndNose.png"/>
        </button>
        <button id="eyebrow-button" class="btn">
            <img src="images/ui/button/eyebrow.png"/>
        </button>
        <button id="mouth-button" class="btn">
            <img src="images/ui/button/mouth.png"/>
        </button>
        <button id="hair-button" class="btn">
            <img src="images/ui/button/hair.png"/>
        </button>
        <button id="clothing-button" class="btn">
            <img src="images/ui/button/clothing.png"/>
        </button>
        <button id="facePaint-button" class="btn">
            <img src="images/ui/button/facePaint.png"/>
        </button>
        <button id="weapon-button" class="btn">
            <img src="images/ui/button/weapon.png"/>
        </button>
        <button id="necklace-button" class="btn">
            <img src="images/ui/button/necklace.png"/>
        </button>
        <button id="headAccessory-button" class="btn">
            <img src="images/ui/button/headAccessory.png"/>
        </button>
    </div>
    <div id="image-list" class="d-flex flex-wrap justify-content-center">
    </div>
    <button onclick="takeshot()">
        이미지 다운로드
    </button>
    <button onclick="reset()">
        초기화
    </button>
    <button onclick="copyUrl()">
        공유하기
    </button>
</div>
<footer>
    <img class="divider" src="images/ui/divider.png">
</footer>

<script>
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);

    window.addEventListener('resize', () => {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
    })
</script>
<script src="script.js"></script>
<script type="text/javascript">
    function takeshot() {
        const element = document.getElementById('capture');
        const scale = 3;
        domtoimage.toBlob(element, {
            width: element.clientWidth * scale,
            height: element.clientHeight * scale,
            style: {
                transform: 'scale(' + scale + ')',
                transformOrigin: 'top left'
            }
        }).then(function (blob) {
            saveAs(blob, 'malama-aina.png');
        });
    }

    function reset() {
        const defaultImages = {
            clothing: "images/components/clothing/clothing3.png",
            eyesAndNose: "images/components/eyesAndNose/eyesAndNose2.png",
            weapon: "images/components/weapon/weapon1.png",
            eyebrow: "images/components/eyebrow/eyebrow1.png",
            headAccessory: "images/components/blank.png",
            facePaint: "images/components/blank.png",
            hair: "images/components/blank.png",
            necklace: "images/components/blank.png",
        }

        for (const type in defaultImages) {
            const element = document.getElementById(`${type}`);
            element.style.backgroundImage = `url(${defaultImages[type]})`;
        }
    }

    function copyUrl() {
        // todo: url에 이미지 렌더링 정보 넣기
        navigator.clipboard.writeText(window.location.href);
    }
</script>
</body>
</html>
